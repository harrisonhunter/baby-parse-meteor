/*
    Minified version of:
    Baby Parse
    v0.4.1
    https://github.com/Rich-Harris/BabyParse
    Created by Rich Harris
    Maintained by Matt Holt
    Based on Papa Parse v4.0.7 by Matt Holt
    https://github.com/mholt/PapaParse
*/
(function(e){function r(e,t){var n=u(t);var r=new s(n);var i=r.parse(e);if(f(n.complete))n.complete(i);return i}function i(e,t){function a(){if(typeof t!=="object")return;if(typeof t.delimiter==="string"&&t.delimiter.length==1&&n.BAD_DELIMITERS.indexOf(t.delimiter)==-1){o=t.delimiter}if(typeof t.quotes==="boolean"||t.quotes instanceof Array)s=t.quotes;if(typeof t.newline==="string")u=t.newline}function f(e){if(typeof e!=="object")return[];var t=[];for(var n in e)t.push(n);return t}function l(e,t){var n="";if(typeof e==="string")e=JSON.parse(e);if(typeof t==="string")t=JSON.parse(t);var r=e instanceof Array&&e.length>0;var i=!(t[0]instanceof Array);if(r){for(var s=0;s<e.length;s++){if(s>0)n+=o;n+=c(e[s],s)}if(t.length>0)n+=u}for(var a=0;a<t.length;a++){var f=r?e.length:t[a].length;for(var l=0;l<f;l++){if(l>0)n+=o;var h=r&&i?e[l]:l;n+=c(t[a][h],l)}if(a<t.length-1)n+=u}return n}function c(e,t){if(typeof e==="undefined"||e===null)return"";e=e.toString().replace(/"/g,'""');var r=typeof s==="boolean"&&s||s instanceof Array&&s[t]||h(e,n.BAD_DELIMITERS)||e.indexOf(o)>-1||e.charAt(0)==" "||e.charAt(e.length-1)==" ";return r?'"'+e+'"':e}function h(e,t){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return true;return false}var r="";var i=[];var s=false;var o=",";var u="\r\n";a();if(typeof e==="string")e=JSON.parse(e);if(e instanceof Array){if(!e.length||e[0]instanceof Array)return l(null,e);else if(typeof e[0]==="object")return l(f(e[0]),e)}else if(typeof e==="object"){if(typeof e.data==="string")e.data=JSON.parse(e.data);if(e.data instanceof Array){if(!e.fields)e.fields=e.data[0]instanceof Array?e.fields:f(e.data[0]);if(!(e.data[0]instanceof Array)&&typeof e.data[0]!=="object")e.data=[e.data]}return l(e.fields||[],e.data||[])}throw"exception: Unable to serialize unrecognized input"}function s(e){function v(){if(p&&c){S("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+n.DefaultDelimiter+"'");c=false}if(e.skipEmptyLines){for(var t=0;t<p.data.length;t++)if(p.data[t].length==1&&p.data[t][0]=="")p.data.splice(t--,1)}if(m())g();return y()}function m(){return e.header&&h.length==0}function g(){if(!p)return;for(var e=0;m()&&e<p.data.length;e++)for(var t=0;t<p.data[e].length;t++)h.push(p.data[e][t]);p.data.splice(0,1)}function y(){if(!p||!e.header&&!e.dynamicTyping)return p;for(var t=0;t<p.data.length;t++){var n={};for(var r=0;r<p.data[t].length;r++){if(e.dynamicTyping){var i=p.data[t][r];if(i=="true")p.data[t][r]=true;else if(i=="false")p.data[t][r]=false;else p.data[t][r]=E(i)}if(e.header){if(r>=h.length){if(!n["__parsed_extra"])n["__parsed_extra"]=[];n["__parsed_extra"].push(p.data[t][r])}else n[h[r]]=p.data[t][r]}}if(e.header){p.data[t]=n;if(r>h.length)S("FieldMismatch","TooManyFields","Too many fields: expected "+h.length+" fields but parsed "+r,t);else if(r<h.length)S("FieldMismatch","TooFewFields","Too few fields: expected "+h.length+" fields but parsed "+r,t)}}if(e.header&&p.meta)p.meta.fields=h;return p}function b(t){var r=[",","    ","|",";",n.RECORD_SEP,n.UNIT_SEP];var i,s,u;for(var a=0;a<r.length;a++){var f=r[a];var l=0,c=0;u=undefined;var h=(new o({delimiter:f,preview:10})).parse(t);for(var p=0;p<h.data.length;p++){var d=h.data[p].length;c+=d;if(typeof u==="undefined"){u=d;continue}else if(d>1){l+=Math.abs(d-u);u=d}}c/=h.data.length;if((typeof s==="undefined"||l<s)&&c>1.99){s=l;i=f}}e.delimiter=i;return{successful:!!i,bestDelimiter:i}}function w(e){e=e.substr(0,1024*1024);var t=e.split("\r");if(t.length==1)return"\n";var n=0;for(var r=0;r<t.length;r++){if(t[r][0]=="\n")n++}return n>=t.length/2?"\r\n":"\r"}function E(e){var n=t.test(e);return n?parseFloat(e):e}function S(e,t,n,r){p.errors.push({type:e,code:t,message:n,row:r})}var t=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i;var r=this;var i=0;var s;var u;var l=false;var c;var h=[];var p={data:[],errors:[],meta:{}};if(f(e.step)){var d=e.step;e.step=function(t){p=t;if(m())v();else{v();if(p.data.length==0)return;i+=t.data.length;if(e.preview&&i>e.preview)u.abort();else d(p,r)}}}this.parse=function(t){if(!e.newline)e.newline=w(t);c=false;if(!e.delimiter){var i=b(t);if(i.successful)e.delimiter=i.bestDelimiter;else{c=true;e.delimiter=n.DefaultDelimiter}p.meta.delimiter=e.delimiter}var h=a(e);if(e.preview&&e.header)h.preview++;s=t;u=new o(h);p=u.parse(s);v();if(f(e.complete)&&!l&&(!r.streamer||r.streamer.finished()))e.complete(p);return l?{meta:{paused:true}}:p||{meta:{paused:false}}};this.pause=function(){l=true;u.abort();s=s.substr(u.getCharIndex())};this.resume=function(){l=false;u=new o(e);u.parse(s);if(!l){if(r.streamer&&!r.streamer.finished())r.streamer.resume();else if(f(e.complete))e.complete(p)}};this.abort=function(){u.abort();if(f(e.complete))e.complete(p);s=""}}function o(e){e=e||{};var t=e.delimiter;var r=e.newline;var i=e.comments;var s=e.step;var o=e.preview;var u=e.fastMode;if(typeof t!=="string"||t.length!=1||n.BAD_DELIMITERS.indexOf(t)>-1)t=",";if(i===t)throw"Comment character same as delimiter";else if(i===true)i="#";else if(typeof i!=="string"||n.BAD_DELIMITERS.indexOf(i)>-1)i=false;if(r!="\n"&&r!="\r"&&r!="\r\n")r="\n";var a=0;var f=false;this.parse=function(e){function S(){m.push(e.substr(a));d.push(m);a=n;if(p)N();return T()}function x(t){d.push(m);m=[];a=t;w=e.indexOf(r,a)}function T(e){return{data:d,errors:v,meta:{delimiter:t,linebreak:r,aborted:f,truncated:!!e}}}function N(){s(T());d=[],v=[]}if(typeof e!=="string")throw"Input must be a string";var n=e.length,l=t.length,c=r.length,h=i.length;var p=typeof s==="function";a=0;var d=[],v=[],m=[];if(!e)return T();if(u){var g=e.split(r);for(var y=0;y<g.length;y++){if(i&&g[y].substr(0,h)==i)continue;if(p){d=[g[y].split(t)];N();if(f)return T()}else d.push(g[y].split(t));if(o&&y>=o){d=d.slice(0,o);return T(true)}}return T()}var b=e.indexOf(t,a);var w=e.indexOf(r,a);for(;;){if(e[a]=='"'){var E=a;a++;for(;;){var E=e.indexOf('"',E+1);if(E===-1){v.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:d.length,index:a});return S()}if(E===n-1){m.push(e.substring(a,E).replace(/""/g,'"'));d.push(m);if(p)N();return T()}if(e[E+1]=='"'){E++;continue}if(e[E+1]==t){m.push(e.substring(a,E).replace(/""/g,'"'));a=E+1+l;b=e.indexOf(t,a);w=e.indexOf(r,a);break}if(e.substr(E+1,c)===r){m.push(e.substring(a,E).replace(/""/g,'"'));x(E+1+c);b=e.indexOf(t,a);if(p){N();if(f)return T()}if(o&&d.length>=o)return T(true);break}}continue}if(i&&m.length===0&&e.substr(a,h)===i){if(w==-1)return T();a=w+c;w=e.indexOf(r,a);b=e.indexOf(t,a);continue}if(b!==-1&&(b<w||w===-1)){m.push(e.substring(a,b));a=b+l;b=e.indexOf(t,a);continue}if(w!==-1){m.push(e.substring(a,w));x(w+c);if(p){N();if(f)return T()}if(o&&d.length>=o)return T(true);continue}break}return S()};this.abort=function(){f=true};this.getCharIndex=function(){return a}}function u(e){if(typeof e!=="object")e={};var r=a(e);if(typeof r.delimiter!=="string"||r.delimiter.length!=1||n.BAD_DELIMITERS.indexOf(r.delimiter)>-1)r.delimiter=t.delimiter;if(r.newline!="\n"&&r.newline!="\r"&&r.newline!="\r\n")r.newline=t.newline;if(typeof r.header!=="boolean")r.header=t.header;if(typeof r.dynamicTyping!=="boolean")r.dynamicTyping=t.dynamicTyping;if(typeof r.preview!=="number")r.preview=t.preview;if(typeof r.step!=="function")r.step=t.step;if(typeof r.complete!=="function")r.complete=t.complete;if(typeof r.skipEmptyLines!=="boolean")r.skipEmptyLines=t.skipEmptyLines;if(typeof r.fastMode!=="boolean")r.fastMode=t.fastMode;return r}function a(e){if(typeof e!=="object")return e;var t=e instanceof Array?[]:{};for(var n in e)t[n]=a(e[n]);return t}function f(e){return typeof e==="function"}var t={delimiter:"",newline:"",header:false,dynamicTyping:false,preview:0,step:undefined,comments:false,complete:undefined,skipEmptyLines:false,fastMode:false};var n={};n.parse=r;n.unparse=i;n.RECORD_SEP=String.fromCharCode(30);n.UNIT_SEP=String.fromCharCode(31);n.BYTE_ORDER_MARK="ï»¿";n.BAD_DELIMITERS=["\r","\n",'"',n.BYTE_ORDER_MARK];n.DefaultDelimiter=",";n.Parser=o;n.ParserHandle=s;if(typeof module!=="undefined"&&module.exports){module.exports=n}else if(typeof define==="function"&&define.amd){define(function(){return n})}else{e.Baby=n}})(typeof window!=="undefined"?window:this)
